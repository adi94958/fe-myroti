"use strict";(self.webpackChunk_coreui_coreui_free_react_admin_template=self.webpackChunk_coreui_coreui_free_react_admin_template||[]).push([[4],{1004:(a,i,e)=>{e.r(i),e.d(i,{default:()=>j});var t=e(2791),r=e(1830),s=e.n(r),n=e(5294),l=e(2937),o=e(3400),c=e(4040),d=e(4846),h=e(7689),u=e(184);const j=()=>{const a=(0,h.s0)(),[i,e]=(0,t.useState)(!1),[r,j]=(0,t.useState)([]),[m,x]=(0,t.useState)(!1),[_,p]=(0,t.useState)(!1),[k,g]=(0,t.useState)([]),[N,v]=(0,t.useState)(""),[f,b]=(0,t.useState)([]),[C,y]=(0,t.useState)(1),[S,R]=(0,t.useState)(10),[T,w]=(0,t.useState)([]),[L,M]=(0,t.useState)([]),B=[10,25,50,T.length],[A,Z]=(0,t.useState)("");(0,t.useEffect)((()=>{D()}),[]);const D=async()=>{try{const a=JSON.parse(localStorage.getItem("dataLogin"));Z(a.id);const i=await n.Z.get("https://be-myroti-production.up.railway.app/api/kurir/transaksi");w(i.data);const e=i.data.map((a=>({id_transaksi:a.id_transaksi,catatan_penjual:"",total_dengan_rotibasi:0})));M(e),i.data.map((a=>{const i=a.transaksi_roti.map((a=>({id_transaksi:a.id_transaksi,kode_roti:a.roti.kode_roti,harga_satuan_roti:a.roti.harga_satuan_roti,jumlah_roti:0,jumlah_roti_dikirim:a.jumlah_roti})));b(i)}))}catch(a){console.error("Error fetching data:",a)}};const[P,E]=(0,t.useState)([]);(0,t.useEffect)((()=>{const a=T.map((a=>{const i=a.transaksi_roti.reduce(((a,i)=>a+i.jumlah_roti*i.roti.harga_satuan_roti),0);return{...a,totalHargaRoti:i}}));E(a)}),[T]);const H=P.filter((a=>{var i,e;const t=((null===a||void 0===a||null===(i=a.lapak.nama_lapak)||void 0===i||null===(e=i.toString())||void 0===e?void 0:e.toLowerCase())||"").includes(N.toLowerCase()),r="delivered"==(null===a||void 0===a?void 0:a.status),s=(null===a||void 0===a?void 0:a.id_kurir)===A;return r&&s&&t})),[O,I]=(0,t.useState)([]),J=(C-1)*S,V=S===T.length?T.length:J+S,Y=H.slice(J,V),z=J+1,q=Math.min(J+S,H.length),F=0===H.length;return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)(l.xH,{children:[(0,u.jsx)(l.bn,{children:"Daftar Pengiriman"}),(0,u.jsxs)(l.sl,{children:[(0,u.jsx)(l.lx,{className:"mb-3",children:(0,u.jsxs)(l.rb,{children:[(0,u.jsx)(l.b7,{md:8,xs:6,children:(0,u.jsxs)(l.YR,{children:[(0,u.jsx)(l.jO,{type:"text",placeholder:"Search...",value:N,onChange:a=>v(a.target.value)}),(0,u.jsx)(l.u5,{variant:"outline",className:"ms-2",children:(0,u.jsx)(d.Z,{icon:o.j})})]})}),(0,u.jsx)(l.b7,{md:2,xs:3,children:(0,u.jsx)(l.L8,{children:"Rows Per Page:"})}),(0,u.jsx)(l.b7,{md:2,xs:3,children:(0,u.jsx)(l.LX,{className:"form-select",value:S,onChange:a=>{return i=parseInt(a.target.value),y(1),void R(i);var i},children:B.map((a=>(0,u.jsx)("option",{value:a,children:a===T.length?"All":a},a)))})})]})}),(0,u.jsxs)(l.Sx,{striped:!0,bordered:!0,responsive:!0,children:[(0,u.jsx)(l.V,{children:(0,u.jsxs)(l.T6,{children:[(0,u.jsx)(l.is,{children:"No"}),(0,u.jsx)(l.is,{children:"Nama Lapak"}),(0,u.jsx)(l.is,{children:"Alamat Lengkap"}),(0,u.jsx)(l.is,{children:"Tgl Pengiriman"}),(0,u.jsx)(l.is,{children:"Daftar Roti"}),(0,u.jsx)(l.is,{children:"Total Harga"}),(0,u.jsx)(l.is,{children:"Roti Basi"}),(0,u.jsx)(l.is,{children:"Catatan"}),(0,u.jsx)(l.is,{children:"Status"}),(0,u.jsx)(l.is,{children:"Aksi"})]})}),(0,u.jsx)(l.NR,{children:0===Y.length?(0,u.jsx)("tr",{children:(0,u.jsx)("td",{colSpan:"10",className:"text-center",children:"Tidak ada data."})}):Y.map(((a,i)=>(0,u.jsxs)(l.T6,{children:[(0,u.jsx)(l.NN,{children:J+i+1}),(0,u.jsx)(l.NN,{children:a.lapak.nama_lapak}),(0,u.jsx)(l.NN,{children:a.lapak.alamat_lapak}),(0,u.jsx)(l.NN,{children:a.tanggal_pengiriman}),(0,u.jsx)(l.NN,{children:(0,u.jsxs)(l.u5,{color:"primary",variant:"outline",className:"ms-2",title:"Daftar Roti",onClick:()=>function(a){e(!0),g(a.transaksi_roti)}(a),children:[(0,u.jsx)(d.Z,{icon:o.j,className:"mx-12 me-2"}),"Open Detail"]})}),(0,u.jsx)(l.NN,{children:a.totalHargaRoti}),(0,u.jsx)(l.NN,{children:(0,u.jsxs)(l.u5,{color:"primary",variant:"outline",className:"ms-2",title:"Daftar Roti Basi",onClick:()=>function(a){x(!0),g(a.transaksi_roti)}(a),children:[(0,u.jsx)(d.Z,{icon:c.C,className:"mx-12 me-2"}),"Input Roti Basi"]})}),(0,u.jsx)(l.NN,{children:(0,u.jsx)(l.PB,{id:"catatan",name:"catatan",value:L.catatan_penjual,onChange:i=>{return e=i,t=a,void M((a=>a.map((a=>a.id_transaksi===t.id_transaksi?{...a,catatan_penjual:e.target.value}:a))));var e,t},placeholder:"Masukkan catatan Anda di sini..."})}),(0,u.jsx)(l.NN,{style:{color:"orange"},children:a.status}),(0,u.jsx)(l.NN,{children:(0,u.jsx)(l.u5,{color:"primary",variant:"outline",className:"ms-2",title:"submit",onClick:()=>(async a=>{const i=f.map((i=>{if(i.id_transaksi===a.id_transaksi)return i.kode_roti})),e=f.map((i=>{if(i.id_transaksi===a.id_transaksi)return i.jumlah_roti})),t=L.find((i=>i.id_transaksi===a.id_transaksi)),r={kode_roti:i,jumlah_roti:e,catatan_penjual:""===t.catatan_penjual?"-":t.catatan_penjual,total_harga:a.totalHargaRoti,total_dengan_rotibasi:t.total_dengan_rotibasi,uang_setoran:a.totalHargaRoti-t.total_dengan_rotibasi};try{await n.Z.post("https://be-myroti-production.up.railway.app/api/kurir/penjualan/".concat(a.id_transaksi),r),s().fire({title:"Berhasil",text:"Berhasil di submit.",icon:"success",confirmButtonText:"OK"}).then((a=>{a.isConfirmed&&(window.location.href="/kurir/daftar-pengiriman")}))}catch(l){p(!1)}})(a),children:"Submit"})})]},i)))})]}),(0,u.jsx)(l.rb,{className:"mt-2 mb-2",children:(0,u.jsxs)(l.b7,{md:4,xs:8,children:["Total Rows: ",H.length," Page: ",z," of ",q]})}),(0,u.jsxs)(l.E7,{activepage:C,pages:Math.ceil(H.length/S),onActivePageChange:y,align:"center",doublearrows:"false",children:[(0,u.jsx)(l.tn,{onClick:()=>!F&&y(C-1),disabled:1===C||F,style:{cursor:F?"default":"pointer"},children:"Prev"}),Array.from({length:Math.ceil(H.length/S)},((a,i)=>{const e=i+1,t=Math.ceil(H.length/S);return e>=C-1&&e<=C+1||t<=3||1===C&&e<=3||C===t&&e>=t-2?(0,u.jsx)(l.tn,{active:e===C,onClick:()=>y(e),style:{cursor:"pointer"},children:e},e):1===e&&C>2||e===t&&C<t-1?(0,u.jsx)(l.tn,{disabled:!0,style:{cursor:"default"},children:"..."},e):null})),(0,u.jsx)(l.tn,{onClick:()=>!F&&y(C+1),disabled:C===Math.ceil(H.length/S)||F,style:{cursor:F?"default":"pointer"},children:"Next"})]})]})]}),(0,u.jsxs)(l.Tk,{backdrop:"static",visible:i,className:"modal",onClose:()=>{e(!1),p(!1)},children:[(0,u.jsx)(l.p0,{closeButton:!0,children:(0,u.jsx)(l.fl,{children:"Daftar Roti"})}),(0,u.jsx)(l.sD,{children:(0,u.jsxs)(l.Sx,{striped:!0,bordered:!0,responsive:!0,children:[(0,u.jsx)(l.V,{children:(0,u.jsxs)(l.T6,{children:[(0,u.jsx)(l.is,{children:"Nama Roti"}),(0,u.jsx)(l.is,{children:"Jumlah Roti"})]})}),(0,u.jsx)(l.NR,{children:k.map(((a,i)=>(0,u.jsxs)(l.T6,{children:[(0,u.jsx)(l.NN,{children:a.roti.nama_roti}),(0,u.jsx)(l.NN,{children:a.jumlah_roti})]},i)))})]})}),(0,u.jsx)(l.Ym,{children:(0,u.jsx)(l.u5,{color:"secondary",onClick:()=>{e(!1)},children:"Close"})})]}),(0,u.jsxs)(l.Tk,{backdrop:"static",visible:m,className:"modal",onClose:()=>{x(!1),p(!1)},children:[(0,u.jsx)(l.p0,{closeButton:!0,children:(0,u.jsx)(l.fl,{children:"Daftar Roti"})}),(0,u.jsx)(l.sD,{children:(0,u.jsxs)(l.Sx,{striped:!0,bordered:!0,responsive:!0,children:[(0,u.jsx)(l.V,{children:(0,u.jsxs)(l.T6,{children:[(0,u.jsx)(l.is,{children:"Nama Roti"}),(0,u.jsx)(l.is,{children:"Jumlah Roti Dikirim"}),(0,u.jsx)(l.is,{children:"Jumlah Roti Basi"})]})}),(0,u.jsx)(l.NR,{children:k.map(((a,i)=>{var e;return(0,u.jsxs)(l.T6,{children:[(0,u.jsx)(l.NN,{children:a.roti.nama_roti}),(0,u.jsx)(l.NN,{children:a.jumlah_roti}),(0,u.jsx)(l.NN,{children:(0,u.jsx)(l.lx,{children:(0,u.jsx)(l.jO,{size:"sm",name:"jumlah_roti",value:null!==(e=O.find((i=>i.kode_roti===a.kode_roti))&&O.find((i=>i.kode_roti===a.kode_roti)).jumlah_roti)&&void 0!==e?e:0,onChange:i=>((a,i)=>{j(a);const e=i.target.value,t=""!==e?parseInt(e,10):0;I((i=>{const e=i.map((i=>i.kode_roti===a.kode_roti?{...i,jumlah_roti:t}:i));return e.some((i=>i.kode_roti===a.kode_roti))||e.push({kode_roti:a.kode_roti,harga_satuan_roti:a.roti.harga_satuan_roti,id_transaksi:a.id_transaksi,jumlah_roti:t,stok_roti:a.jumlah_roti}),e}))})(a,i),required:!0})})})]},i)}))})]})}),(0,u.jsxs)(l.Ym,{children:[(0,u.jsx)(l.u5,{color:"secondary",onClick:()=>{x(!1)},children:"Close"}),_?(0,u.jsx)(l.u5,{color:"primary",disabled:!0,children:(0,u.jsx)(l.LQ,{color:"info",size:"sm"})}):(0,u.jsx)(l.u5,{color:"primary",onClick:()=>(i=>{if(O.every((a=>a.stok_roti>=a.jumlah_roti))){const e=O.reduce(((a,i)=>a+i.jumlah_roti*i.harga_satuan_roti),0);M((a=>a.map((a=>a.id_transaksi===i.id_transaksi?{...a,total_dengan_rotibasi:e}:a)))),x(!1),a("/kurir/daftar-pengiriman")}else s().mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:4e3,timerProgressBar:!0,didOpen:a=>{a.addEventListener("mouseenter",s().stopTimer),a.addEventListener("mouseleave",s().resumeTimer)}}).fire({icon:"error",title:"Maaf! anda melebihi stok roti yang tersedia"})})(r),children:"Selesai"})]})]})]})}},4040:(a,i,e)=>{e.d(i,{C:()=>t});var t=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M345.994,42.019,179.531,208.481A646.3,646.3,0,0,0,25.325,456.521a24.845,24.845,0,0,0,6,25.708l.087.087a24.84,24.84,0,0,0,17.611,7.342,25.172,25.172,0,0,0,8.1-1.344,646.283,646.283,0,0,0,248.04-154.207L471.62,167.646A88.831,88.831,0,0,0,345.994,42.019ZM282.531,311.48A614.445,614.445,0,0,1,60.419,453.221,614.435,614.435,0,0,1,202.158,231.108l99.162-99.161,80.372,80.372ZM448.993,145.019l-44.674,44.673L323.947,109.32l44.674-44.674a56.832,56.832,0,1,1,80.372,80.373Z' class='ci-primary'/>"]},3400:(a,i,e)=>{e.d(i,{j:()=>t});var t=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M479.6,399.716l-81.084-81.084-62.368-25.767A175.014,175.014,0,0,0,368,192c0-97.047-78.953-176-176-176S16,94.953,16,192,94.953,368,192,368a175.034,175.034,0,0,0,101.619-32.377l25.7,62.2L400.4,478.911a56,56,0,1,0,79.2-79.195ZM48,192c0-79.4,64.6-144,144-144s144,64.6,144,144S271.4,336,192,336,48,271.4,48,192ZM456.971,456.284a24.028,24.028,0,0,1-33.942,0l-76.572-76.572-23.894-57.835L380.4,345.771l76.573,76.572A24.028,24.028,0,0,1,456.971,456.284Z' class='ci-primary'/>"]}}]);
//# sourceMappingURL=4.311a98d6.chunk.js.map